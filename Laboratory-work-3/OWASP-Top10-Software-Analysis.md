|Ідентифікатор та назва атаки (вразливості)|Вимога (FR,NFR)|Приклад вразливостей, які може використовувати атака|Приклад запобігання успішної реалізації атаки|
|------------------------------------------|---------------|----------------------------------------------------|---------------------------------------------|
|A01:2021 – Broken Access Control (Порушений контроль доступу)| FR1. Функція ідентифікації в застосунку </br> FR3. Функція перегляду списку заповнених звітів користувача </br> FR4. Функція заповнення користувачем нового звіту|Порушення принципу найменших привілеїв або заборони за замовчуванням, де доступ має надаватися лише для певних можливостей, ролей або користувачів, але доступний для всіх </br> Дозвіл на перегляд або редагування чужого облікового запису шляхом надання його унікального ідентифікатора (незахищені прямі посилання на об’єкти) </br> Доступ до API із відсутніми елементами керування доступом для POST, PUT і DELETE | За винятком загальнодоступних ресурсів, заборонити за умовчанням </br> Контроль доступу моделі повинен забезпечувати право власності на запис, а не приймати, що користувач може створювати, читати, оновлювати або видаляти будь-який запис </br> Реєстрація збоїв контролю доступу, сповіщення адміністраторів, якщо це необхідно (наприклад, повторні збої) | 
|A02:2021 – Cryptographic Failures (Криптографічні збої)| FR1. Функція ідентифікації в застосунку </br> FR4. Функція заповнення користувачем нового звіту|Чи використовуються паролі як криптографічні ключі за відсутності функції виведення базового ключа пароля? </br> Чи вектори ініціалізації ігноруються, повторно використовуються чи генеруються недостатньо безпечно для криптографічного режиму роботи? Чи використовується незахищений режим роботи, наприклад ECB? Чи використовується шифрування, коли автентифіковане шифрування є більш прийнятним? </br> Чи можна використати криптографічні повідомлення про помилки або інформацію з побічного каналу, наприклад, у формі атак оракула? | Класифікуйте дані, які обробляються, зберігаються або передаються програмою.Визначте, які дані є конфіденційними відповідно до законів про конфіденційність, нормативних вимог або потреб бізнесу</br> Не зберігайте конфіденційні дані без потреби. Відмовтеся від нього якнайшвидше або скористайтеся сумісною з PCI DSS токенізацією чи навіть скороченням. Дані, які не зберігаються, не можуть бути викрадені </br> Переконайтеся, що ви зашифрували всі конфіденційні дані в стані спокою </br> Зберігайте паролі, використовуючи надійні адаптивні та засолені функції хешування з робочим фактором (фактором затримки), наприклад Argon2, scrypt, bcrypt або PBKDF2 </br> Вектори ініціалізації повинні бути обрані відповідно до режиму роботи. Для багатьох режимів це означає використання CSPRNG (криптографічно захищений генератор псевдовипадкових чисел). Для режимів, які вимагають nonce, вектор ініціалізації (IV) не потребує CSPRNG. У всіх випадках IV ніколи не слід використовувати двічі для фіксованого ключа </br> Завжди використовуйте автентифіковане шифрування замість простого шифрування|
|A03:2021 – Injection (Ін'єкція) |FR3. Функція перегляду списку заповнених звітів користувача </br> FR7. Функція редагування звіту користувачем| Динамічні запити або непараметризовані виклики без контекстно-залежного екранування використовуються безпосередньо в інтерпретаторі </br> Ворожі дані використовуються в параметрах пошуку об’єктно-реляційного відображення (ORM) для отримання додаткових конфіденційних записів </br> Ворожі дані використовуються безпосередньо або об’єднуються. SQL або команда містить структуру та шкідливі дані в динамічних запитах, командах або збережених процедурах | Використовуйте позитивну перевірку введення на стороні сервера. Це не повний захист, оскільки для багатьох програм потрібні спеціальні символи, наприклад текстові області або API для мобільних програм </br> Для будь-яких залишкових динамічних запитів екрануйте спеціальні символи, використовуючи спеціальний синтаксис екранування для цього інтерпретатора </br> Примітка. Такі структури SQL, як імена таблиць, імена стовпців тощо, не можна екранувати, тому надані користувачем імена структур небезпечні. Це поширена проблема в програмному забезпеченні для створення звітів </br>Використовуйте LIMIT та інші елементи керування SQL у запитах, щоб запобігти масовому розкриттю записів у разі впровадження SQL |
|A05:2021 – Security Misconfiguration (Неправильна конфігурація безпеки)|FR1. Функція ідентифікації в застосунку </br> FR3. Функція перегляду списку заповнених звітів користувача </br> FR4. Функція заповнення користувачем нового звіту|Відсутність відповідного посилення безпеки в будь-якій частині стеку програм або неправильно налаштовані дозволи для хмарних служб </br> Увімкнено або встановлено непотрібні функції (наприклад, непотрібні порти, служби, сторінки, облікові записи або привілеї)</br> Обробка помилок виявляє користувачам трасування стека або інші надто інформативні повідомлення про помилки </br> Для оновлених систем найновіші функції безпеки вимкнено або неналаштовано безпечно </br> Параметри безпеки на серверах додатків, платформах додатків (наприклад, Struts, Spring, ASP.NET), бібліотеках, базах даних тощо не мають безпечних значень </br> Сервер не надсилає заголовки безпеки чи директиви, або для них не встановлено безпечні значення | Мінімальна платформа без будь-яких непотрібних функцій, компонентів, документації та зразків. Видаліть або не встановлюйте функції та фреймворки, які не використовуються </br> Завдання переглядати й оновлювати конфігурації, що відповідають усім приміткам щодо безпеки, оновленням і виправленням у рамках процесу керування виправленнями. Перегляньте дозволи на хмарне сховище (наприклад, дозволи на відро S3) </br> Сегментована архітектура програми забезпечує ефективне та безпечне розділення між компонентами або орендарями за допомогою сегментації, контейнеризації або хмарних груп безпеки (ACL) </br> Надсилання директив безпеки клієнтам, наприклад, заголовків безпеки </br> Автоматизований процес перевірки ефективності конфігурацій і налаштувань у всіх середовищах | 
|A06:2021 – Vulnerable and Outdated Components (Вразливі та застарілі компоненти)| |Якщо ви не виправите або не оновите базову платформу, фреймворки та залежності вчасно з урахуванням ризиків. Це зазвичай трапляється в середовищах, коли виправлення є щомісячним або щоквартальним завданням під контролем змін, залишаючи організації відкритими для днів або місяців непотрібного впливу виправлених уразливостей </br> Якщо розробники програмного забезпечення не перевіряють сумісність оновлених, оновлених або виправлених бібліотек </br> Якщо ви не захищаєте конфігурації компонентів | Видаліть невикористовувані залежності, непотрібні функції, компоненти, файли та документацію </br> Постійно інвентаризуйте версії як клієнтських, так і серверних компонентів (наприклад, фреймворків, бібліотек) і їхніх залежностей, використовуючи такі інструменти, як версії, OWASP Dependency Check, retire.js тощо. Постійно відстежуйте джерела, як-от загальні вразливості та експозиції (CVE) і національну базу даних про вразливості (NVD) щодо вразливостей у компонентах. Використовуйте інструменти аналізу складу програмного забезпечення для автоматизації процесу. Підпишіться на сповіщення електронною поштою про вразливості безпеки, пов’язані з компонентами, які ви використовуєте </br> Отримуйте компоненти лише з офіційних джерел через безпечні посилання. Віддавайте перевагу підписаним пакетам, щоб зменшити ймовірність включення модифікованого шкідливого компонента (див. A08:2021 – Збої цілісності програмного забезпечення та даних)</br> Слідкуйте за бібліотеками та компонентами, які не обслуговуються або не створюють виправлення безпеки для старіших версій. Якщо виправлення неможливо, подумайте про розгортання віртуального патча для моніторингу, виявлення або захисту від виявленої проблеми |
|A07:2021 – Помилки ідентифікації та автентифікації|FR1. Функція ідентифікації в застосунку| Відсутня або неефективна багатофакторна автентифікація </br> Розкриває ідентифікатор сеансу в URL-адресі </br> Повторне використання ідентифікатора сеансу після успішного входу </br> Ідентифікатори сеансу неправильно роблять недійсними. Сеанси користувача або маркери автентифікації (переважно маркери єдиного входу (SSO)) не анулюються належним чином під час виходу з системи або періоду бездіяльності </br> Дозволяє автоматизовані атаки, як-от перекидання облікових даних, коли зловмисник має список дійсних імен користувачів і паролі | Якщо це можливо, застосуйте багатофакторну автентифікацію, щоб запобігти автоматизованому підкиданню облікових даних, грубій форсації та атакам повторного використання вкрадених облікових даних </br> Не надсилайте та не розгортайте облікові дані за замовчуванням, особливо для користувачів із правами адміністратора. Використовуйте серверний безпечний вбудований менеджер сеансів, який генерує новий випадковий ідентифікатор сеансу з високою ентропією після входу. Ідентифікатор сеансу не має бути в URL-адресі, надійно зберігатися та вважатися недійсним після виходу з системи, простою та абсолютних тайм-аутів | 
|A08:2021 – Порушення цілісності програмного забезпечення та даних | FR3. Функція перегляду списку заповнених звітів користувача </br> FR7. Функція редагування звіту користувачем | Незахищений конвеєр CI/CD може призвести до несанкціонованого доступу, зловмисного коду або компрометації системи </br> Зловмисники потенційно можуть завантажити власні оновлення для розповсюдження та запуску на всіх інсталяціях | Використовуйте цифрові підписи або подібні механізми, щоб переконатися, що програмне забезпечення або дані походять з очікуваного джерела та не були змінені </br> Переконайтеся, що бібліотеки та залежності, такі як npm або Maven, використовують надійні репозиторії. Якщо у вас вищий профіль ризику, подумайте про розміщення перевіреного внутрішнього завідомо справного сховища </br> Переконайтеся, що є процес перевірки коду та змін конфігурації, щоб мінімізувати ймовірність того, що зловмисний код або конфігурація можуть бути введені у ваш конвеєр програмного забезпечення </br> Переконайтеся, що ваш конвеєр CI/CD має належну сегрегацію, конфігурацію та контроль доступу, щоб забезпечити цілісність коду, що проходить через процеси створення та розгортання <br> Переконайтеся, що непідписані або незашифровані серіалізовані дані не надсилаються ненадійним клієнтам без певної форми перевірки цілісності або цифрового підпису для виявлення підробки або повторного відтворення серіалізованих даних | 
|A09:2021 – Помилки реєстрації та моніторингу безпеки| FR1. Функція ідентифікації в застосунку </br> FR3. Функція перегляду списку заповнених звітів користувача </br> FR4. Функція заповнення користувачем нового звіту| Попередження та помилки не створюють жодних, неадекватних або незрозумілих повідомлень журналу </br> Журнали програм і API не перевіряються на наявність підозрілої активності </br> Журнали зберігаються лише локально </br> Відповідні порогові значення сповіщень і процеси ескалації відповіді відсутні або не діють </br> Програма не може виявляти, ескалувати або сповіщати про активні атаки в режимі реального часу або майже в реальному часі | Переконайтеся, що журнали генеруються у форматі, який легко можуть використовувати рішення для керування журналами </br> Переконайтеся, що дані журналу закодовані правильно, щоб запобігти ін’єкціям або атакам на системи реєстрації чи моніторингу </br> Переконайтеся, що транзакції з великою вартістю мають журнал аудиту з контролем цілісності, щоб запобігти втручанню або видаленню, наприклад таблиці бази даних, які лише додаються, тощо | 
|A10:2021 – Підробка запитів на стороні сервера (SSRF)| FR3. Функція перегляду списку заповнених звітів користувача </br> FR7. Функція редагування звіту користувачем | Помилки SSRF виникають щоразу, коли веб-програма отримує віддалений ресурс без перевірки наданої користувачем URL-адреси. Це дозволяє зловмиснику змусити програму надіслати створений запит до неочікуваного адресата, навіть якщо він захищений брандмауером, VPN або іншим типом списку контролю доступу до мережі (ACL) | Розділіть функції віддаленого доступу до ресурсів у окремі мережі, щоб зменшити вплив SSRF </br> Очистіть і перевірте всі вхідні дані, надані клієнтом </br> Не надсилайте необроблені відповіді клієнтам </br> Не розгортайте інші служби безпеки на передніх системах (наприклад, OpenID). Контролювати локальний трафік у цих системах (наприклад, localhost) </br> Для інтерфейсів із виділеними та керованими групами користувачів використовуйте мережеве шифрування (наприклад, VPN) у незалежних системах, щоб враховувати дуже високі потреби захисту |
