# V10.3 Розгорнуті елементи керування цілісністю програми / Deployed Application Integrity Controls

Після розгортання програми шкідливий код усе ще можна вставити. Програми повинні захищатися від типових атак, таких як виконання непідписаного коду з ненадійних джерел і захоплення субдоменів.
</br> Дотримання цього розділу, ймовірно, буде оперативним і постійним.
| #    | Опис                                                                                                                                                                                                                  | L1 | L2 | L3 | CWE | 
|------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----|----|----|-----|
|10.3.1| Переконайтеся, що якщо програма має функцію автоматичного оновлення клієнта чи сервера, оновлення мають надходити через безпечні канали та мати цифровий підпис. Код оновлення має перевірити цифровий підпис оновлення перед встановленням або виконанням оновлення.|  ✓  | ✓  | ✓  | 16 |
|10.3.2| Переконайтеся, що програма використовує засоби захисту цілісності, такі як підпис коду або цілісність субресурсу. Програма не повинна завантажувати або виконувати код із ненадійних джерел, наприклад завантажувати включення, модулі, плагіни, код або бібліотеки з ненадійних джерел або Інтернету.|  ✓  | ✓  | ✓  | 353 |
|10.3.3| Переконайтеся, що програма має захист від захоплення субдоменів, якщо програма покладається на записи DNS або субдомени DNS, як-от прострочені доменні імена, застарілі покажчики DNS або CNAME, прострочені проекти в загальнодоступних сховищах вихідного коду або тимчасові хмарні API, безсерверні функції, або відра зберігання (autogen-bucket-id.cloud.example.com) або подібні. Захист може включати регулярну перевірку імен DNS, які використовуються програмами, на предмет закінчення терміну дії або змін.|  ✓  | ✓  | ✓  | 350 |

## CWE КАТЕГОРІЯ: Конфігурація / CWE CATEGORY: Configuration

### Опис
Слабкі місця в цій категорії зазвичай з’являються під час налаштування програмного забезпечення.

### Картографування

Використання для зіставлення: заборонено (цей ідентифікатор CWE не можна використовувати для зіставлення з реальними вразливими місцями).

Обґрунтування: цей запис є категорією. Використання категорій для відображення активно забороняється принаймні з 2019 року. Категорії — це неформальні організаційні групи слабких місць, які допомагають користувачам CWE навігації та перегляду, але самі по собі вони не є слабкими [REF-1287]. Можливо, цей запис CWE став широко використовуватися через використання NIST у NVD з 2008 по 2016 рік (див. вигляд CWE-635, оновлений до перегляду CWE-1003 у 2016 році). Відображення також заборонено, оскільки цей запис має статус Застарілий.

Коментарі: Починаючи з CWE 4.9, «Конфігурація» починає розглядатися як аспект SDLC, у якому продукт керується (людиною або автоматизованим процесом) виконувати небезпечну поведінку. Відображення CWE має проводитися шляхом аналізу слабких місць у поведінці, встановленій конфігурацією, наприклад тих, що стосуються контролю доступу (нащадки CWE-284) або керування ресурсами (CWE-400) тощо.

### Технічне обслуговування

Подальше обговорення цієї категорії проводилося в списку розсилки CWE Research на початку 2020 року. Остаточних дій не було прийнято.
Технічне обслуговування

Цей запис є категорією, але різні джерела все одно відображають її, незважаючи на вказівки CWE, що категорії не слід відображати. У цьому випадку немає чітких недоліків CWE, які можна було б використати. «Невідповідна конфігурація» звучить більше як слабка сторона в стилі CWE, але це ще не вказує на реальну поведінку продукту. Проте все ще потрібні подальші дослідження, оскільки «слабка конфігурація» може бути первинною для багатьох інших CWE, тобто її краще описати в термінах ланцюжкових зв’язків.

## CWE-350: Довіра до зворотного DNS-розв’язання для критично важливих для безпеки дій / Reliance on Reverse DNS Resolution for a Security-Critical Action
### Опис
Програмне забезпечення виконує зворотне визначення DNS для IP-адреси, щоб отримати ім’я хоста та прийняти рішення щодо безпеки, але воно не гарантує, що IP-адреса справді пов’язана з ім’ям хоста.

### Розгорнутий опис
Оскільки DNS-імена можна легко підробити або неправильно повідомити, а програмному забезпеченню може бути важко виявити, чи надійний DNS-сервер було зламано, DNS-імена не є дійсним механізмом автентифікації.

Коли програмне забезпечення виконує зворотне визначення DNS для IP-адреси, якщо зловмисник контролює сервер для цієї IP-адреси, то зловмисник може змусити сервер повернути довільне ім’я хоста. У результаті зловмисник може обійти автентифікацію, спричинити запис неправильного імені хоста у файлах журналу, щоб приховати дії, або здійснити інші атаки.

Зловмисники можуть підробити DNS-імена, (1) скомпрометувавши DNS-сервер і змінивши його записи (іноді це називається отруєнням DNS-кешу), або (2) отримавши легітимний контроль над DNS-сервером, пов’язаним із їх IP-адресою.
 
### Застосовні платформи

#### Мови
Клас: не залежить від мови (поширеність не визначена)


### Загальні наслідки </br>
| Межі             | Вплив                                                                                           |
|------------------|-------------------------------------------------------------------------------------------------|
| Управління доступом | Технічний вплив: отримати привілеї або присвоїти ідентифікацію; Механізм захисту байпаса. Зловмисники можуть підробити дані автентифікації, надавши неправдиву інформацію DNS.                                                |
  
### Ймовірність експлойту </br>
Висока

## CWE-353: Відсутня підтримка перевірки цілісності / Missing Support for Integrity Check

### Опис
Програмне забезпечення використовує протокол передачі, який не містить механізму перевірки цілісності даних під час передачі, наприклад контрольної суми.

### Розширений опис
Якщо значення перевірки цілісності або «контрольні суми» пропускаються в протоколі, неможливо визначити, чи дані були пошкоджені під час передачі. Відсутність функції контрольної суми в протоколі усуває першу перевірку даних на рівні програми, які можна використовувати. Наскрізна філософія перевірок стверджує, що перевірки цілісності слід виконувати на найнижчому рівні, на якому їх можна повністю реалізувати. За винятком подальших перевірок працездатності та підтвердження введення, що виконується програмами, контрольна сума протоколу є найважливішим рівнем контрольної суми, оскільки її можна виконувати більш повно, ніж на будь-якому попередньому рівні, і враховує цілі повідомлення, на відміну від окремих пакетів.

### Застосовні платформи

#### Мови
Клас: не залежить від мови (поширеність не визначена)


### Загальні наслідки </br>
  | Межі             | Вплив                                                                                           |
  |------------------|-------------------------------------------------------------------------------------------------|
  | Цілісність | Технічний вплив: інше. Дані, які аналізуються та використовуються, можуть бути пошкоджені.       |
  | Не відмова | Технічний вплив: приховати дії. Без контрольної суми неможливо визначити, чи були внесені зміни в дані після їх надсилання.       |
  
### Ймовірність експлойту </br>
Висока
